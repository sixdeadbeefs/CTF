# GET aHEAD
## Description
Find the flag being held on this server to get ahead of the competition:

http://mercury.picoctf.net:21939/

<details>
	<summary> Hint 1: </summary>
	Maybe you have more than 2 choices
</details>

<details>
	<summary> Hint 2: </summary>
	Check out tools like Burpsuite to modify your requests and look at the responses
</details>

## Write Up
Well open up Burpsuite to take a look at the HTTP requests and responses that get generated by clicking either button.

**Choose Red**
When we turn request intercepting on this is the request generated when we click the "Choose Red" button:

```
GET /index.php? HTTP/1.1
Host: mercury.picoctf.net:21939
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:91.0) Gecko/20100101 Firefox/91.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Referer: http://mercury.picoctf.net:21939/index.php?
DNT: 1
Connection: close
Upgrade-Insecure-Requests: 1
```

we can see that is sends a **GET** request to the index.php endpoint.

**Choose Blue**
If we intercept the request when we click "Choose Blue" button this is the request we get:
```
POST /index.php HTTP/1.1
Host: mercury.picoctf.net:21939
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:91.0) Gecko/20100101 Firefox/91.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Referer: http://mercury.picoctf.net:21939/index.php?
Content-Type: application/x-www-form-urlencoded
Content-Length: 0
Origin: http://mercury.picoctf.net:21939
DNT: 1
Connection: close
Upgrade-Insecure-Requests: 1
```

the key difference is that the choose red button sends a **GET** request and the choose blue button sends a **POST** request. 

**HEAD**
Since the name a the challenge is GET aHEAD, it looks looks like it wants us to use the HEAD request type.

> The `HEAD` method asks for a response identical to that of a `GET` request, but without the response body.
> -- <cite>https://developer.mozilla.org/en-US/docs/Web/HTTP/Methods</cite>

To do this we just intercept the GET request and replace the GET keyword with HEAD:

```
HEAD /index.php? HTTP/1.1
Host: mercury.picoctf.net:21939
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:91.0) Gecko/20100101 Firefox/91.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Referer: http://mercury.picoctf.net:21939/index.php
DNT: 1
Connection: close
Upgrade-Insecure-Requests: 1
```

This returns a blank page as expected, but if we look at the HTTP response in Burpsuite we can see that is flag is included as a response header: 

picoCTF{r3j3ct_th3_du4l1ty_6ef27873}